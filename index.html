<!DOCTYPE html>
<html>

<head>
  <title>Index V4</title>
  <script src="https://unpkg.com/jspsych@8.0.0"></script>
  <script src="https://unpkg.com/@jspsych/plugin-preload@1.1.3"></script>
  <script src="https://unpkg.com/@jspsych/plugin-html-keyboard-response@2.0.0"></script>
  <script src="https://unpkg.com/@jspsych/plugin-html-button-response@2.0.0"></script>
  <!-- A custom plugin that adds a green box around the button when it's clicked -->
  <script src="script/jspsych/plugin-html-button-response-green-box.js"></script>
  <!-- A custom plugin that ends the trial when the audio is finished playing -->
  <script src="script/jspsych/plugin-html-end-trial-on-audio-finish.js"></script>
  <script src="https://unpkg.com/@jspsych/plugin-image-keyboard-response@2.0.0"></script>
  <script src="https://unpkg.com/@jspsych/plugin-image-button-response@2.0.0"></script>

  <script src="https://unpkg.com/@jspsych-contrib/plugin-pipe"></script>
  <link href="https://unpkg.com/jspsych@8.0.0/css/jspsych.css" rel="stylesheet" type="text/css" />
</head>

<body></body>
<!-- always init JsPsych first -->
<script src="script/init.js"></script>

<!-- load utils -->
<script src="script/utils/media.js"></script>
<script src="script/utils/stimulus.js"></script>

<!-- load trials -->
<script src="script/instruction_trial.js"></script>
<script src="script/exposure_trial.js"></script>
<script src="script/attention_trial.js"></script>
<script src="script/break_trial.js"></script>
<script src="script/test_trial.js"></script>
<script src="script/ending_trial.js"></script>

<!-- load procedures -->
<script src="script/procedures/introduction.js"></script>
<script src="script/procedures/instruction_exposure_ready.js"></script>
<script src="script/procedures/break.js"></script>
<script src="script/procedures/attention.js"></script>
<script src="script/procedures/exposure.js"></script>
<script src="script/procedures/exposure_practice.js"></script>
<script src="script/procedures/instruction_test.js"></script>
<script src="script/procedures/instruction_test_ready.js"></script>
<script src="script/procedures/test.js"></script>
<script src="script/procedures/test_practice.js"></script>
<script src="script/procedures/ending.js"></script>

<!-- construct experiment -->
<script>
  var timeline = [];
  var instructions = {
    type: jsPsychHtmlKeyboardResponse,
    stimulus: "In this task, you'll do stuff!"
  };
  // preload resolves image flickering
  var preload = {
    type: jsPsychPreload,
    images: introduction_trial_procedure.timeline_variables.map(item => `image/${item.image}`)
  };

  timeline.push(preload);
  timeline.push(instructions);
  // timeline.push(introduction_trial_procedure);
  // timeline.push(exposure_practice_procedure_trial);
  // timeline.push(instruction_exposure_ready_trial_procedure);
  // timeline.push(exposure_procedure1_1);
  // timeline.push(attention_check_procedure1);
  // timeline.push(exposure_procedure1_2);
  // timeline.push(attention_check_procedure2);
  // timeline.push(exposure_procedure1_3);
  // timeline.push(attention_check_procedure3);
  // timeline.push(exposure_procedure1_4);
  timeline.push(attention_check_procedure4);
  timeline.push(break_trial_procedure1);
  timeline.push(exposure_procedure2_1);
  timeline.push(attention_check_procedure5);
  timeline.push(exposure_procedure2_2);
  timeline.push(attention_check_procedure6);
  timeline.push(exposure_procedure2_3);
  timeline.push(attention_check_procedure7);
  timeline.push(exposure_procedure2_4);
  timeline.push(attention_check_procedure8);
  timeline.push(break_trial_procedure2);
  timeline.push(exposure_procedure3_1);
  timeline.push(attention_check_procedure9);
  timeline.push(exposure_procedure3_2);
  timeline.push(attention_check_procedure10);
  timeline.push(exposure_procedure3_3);
  timeline.push(attention_check_procedure11);
  timeline.push(exposure_procedure3_4);
  timeline.push(attention_check_procedure12);
  timeline.push(break_trial_procedure3);
  timeline.push(exposure_procedure4_1);
  timeline.push(attention_check_procedure13);
  timeline.push(exposure_procedure4_2);
  timeline.push(attention_check_procedure14);
  timeline.push(exposure_procedure4_3);
  timeline.push(attention_check_procedure15);
  timeline.push(exposure_procedure4_4);
  timeline.push(attention_check_procedure16);
  timeline.push(break_trial_procedure4);
  timeline.push(instruction_test_trial_procedure);
  timeline.push(test_practice_procedure_1_listen);
  timeline.push(test_practice_procedure_1); 
  timeline.push(test_practice_procedure_2_listen);
  timeline.push(test_practice_procedure_2);
  timeline.push(test_practice_procedure_3_listen)
  timeline.push(test_practice_procedure_3);
  timeline.push(test_practice_procedure_4_listen);
  timeline.push(test_practice_procedure_4);
  timeline.push(instruction_test_ready_trial_procedure);
  timeline.push(dont_touch_screen_prompt_trial_procedure);
  timeline.push(test_procedure_1_listen);
  timeline.push(test_procedure_1);
  timeline.push(dont_touch_screen_prompt_trial_procedure);
  timeline.push(test_procedure_2_listen);
  timeline.push(test_procedure_2);
  timeline.push(test_procedure_3_listen);
  timeline.push(test_procedure_3);
  timeline.push(test_procedure_4_listen);
  timeline.push(test_procedure_4);
  timeline.push(test_procedure_5_listen);
  timeline.push(test_procedure_5);
  timeline.push(test_procedure_6_listen);
  timeline.push(test_procedure_6);
  timeline.push(test_procedure_7_listen);
  timeline.push(test_procedure_7);
  timeline.push(test_procedure_8_listen);
  timeline.push(test_procedure_8);
  timeline.push(test_procedure_9_listen);
  timeline.push(test_procedure_9);
  timeline.push(test_procedure_10_listen);
  timeline.push(test_procedure_10);
  timeline.push(test_procedure_11_listen);
  timeline.push(test_procedure_11);
  timeline.push(test_procedure_12_listen);
  timeline.push(test_procedure_12);
  timeline.push(ending_trial_procedure);


  // const subject_id = jsPsych.randomization.randomID(10);
  // const filename = `${subject_id}.csv`;

  // const save_data = {
  //       type: jsPsychPipe,
  //       action: "save",
  //       experiment_id: "s0JG4pNcCMaK",
  //       filename: filename,
  //       data_string: ()=>jsPsych.data.get().csv()
  //           };
  // timeline.push(save_data);

  jsPsych.run(timeline);



</script>

</html>